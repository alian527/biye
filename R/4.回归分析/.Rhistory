install.packages("caret")
install.packages("reshape2")
install.packages("ggplot2")
install.packages("dplyr")
library(tibble)
library(forestplot)
library(glmnet)
library(caret)
library(foreign)
library(ggplot2)
library(grid)
library(gridExtra)
library(ggpubr)
library(cowplot)
library(ggplot2)
library(readxl)
library(graphics)
library(PerformanceAnalytics)
library(sjPlot)
library(reshape2)
library(dplyr)
library(ggplot2)
library(readxl)
library(gridExtra)
df <- read_excel("原始数据.xlsx")
df <- as.data.frame(df)
rownames(df) =
View(df)
df1=df[,c(1,4,9,24:27)]
View(df1)
View(df)
df1=df[,c(1,5,9,24:27)]
View(df1)
df1=df[,c(2,5,24:27)]
View(df1)
View(df1)
View(df)
df1=df[,c(2,5,13，24:27)]
View(df1)
df1=df[,c(2,5,13,24:27)]
View(df1)
View(df1)
View(df)
df <- read_excel("原始数据.xlsx")
df <- as.data.frame(df)
rownames(df) = df[,1]
df = df[,-1]
df1=df[,c(2,5,13,24:27)]
View(df1)
model1 <- glm(group~`TNF-a`+`IL-6`+`Claudin-5`+Zonulin, data = df1, family = binomial(link = "logit"))
# 使用multinomial分布的广义线性模型
model1 <- glm(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin,
data = df1, family = multinomial(link = "logit"))
install.packages("nnet")
library(nnet)
install.packages("nnet")
library(nnet)
library(nnet)
# 使用multinom函数拟合多分类模型
model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin, data = df1)
# 输出模型摘要
summary(model1)
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin, data = df1)
summary(model1)
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin, data = df1)
summary(model1)
# 获取 Wald 统计量的 p 值
wald.test <- summary(model1, "ztest")
# 获取 Wald 统计量的 Z 分数
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
# 计算双尾 p 值
p_values <- 2 * (1 - pnorm(abs(wald_z)))
# 显示各个预测变量的 p 值
p_values
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin, data = df1)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin, data = df1)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
View(df1)
View(df1)
library(tibble)
library(forestplot)
library(glmnet)
library(caret)
library(foreign)
library(ggplot2)
library(grid)
library(gridExtra)
library(ggpubr)
library(cowplot)
library(ggplot2)
library(readxl)
library(graphics)
library(PerformanceAnalytics)
library(sjPlot)
library(reshape2)
library(dplyr)
library(ggplot2)
library(readxl)
library(gridExtra)
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = df1)
library(nnet)
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = df1)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
dfan <- subset(df1, group == "AN")
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = dfan)
model1 <- model1 <- glm(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = dfan)
model1 <- model1 <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = dfan)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
model1 <- model1 <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = df1)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
model1 <- model1 <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = dfan)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
model1 <- model1 <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = dfhc)
dfan <- subset(df1, group == "AN")
dfhc <- subset(df1, group == "HC")
model1 <- model1 <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = dfhc)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = df1)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin, data = df1)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
model1 <- model1 <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = df1)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
modelan <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = df1an)
modelan <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = dfan)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
modelan1 <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = dfan)
summary(modelan1)
wald_z <- summary(modelan1)$coefficients / summary(modelan1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
modelan2 <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = dfan)
summary(modelan2)
wald_z <- summary(modelan2)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
modelan2 <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = dfan)
summary(modelan2)
wald_z <- summary(modelan2)$coefficients / summary(modelan2)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
modelan2 <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+, data = dfan)
modelan2 <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin, data = dfan)
summary(modelan2)
wald_z <- summary(modelan2)$coefficients / summary(modelan2)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
library(nnet)
library(tibble)
library(forestplot)
library(glmnet)
library(caret)
library(foreign)
library(ggplot2)
library(grid)
library(gridExtra)
library(ggpubr)
library(cowplot)
library(ggplot2)
library(readxl)
library(graphics)
library(PerformanceAnalytics)
library(sjPlot)
library(reshape2)
library(dplyr)
library(ggplot2)
library(readxl)
library(gridExtra)
rm(list = ls())#清空数据
df <- read_excel("原始数据.xlsx")
df <- as.data.frame(df)
rownames(df) = df[,1]
df = df[,-1]
df1=df[,c(2,5,13,24:27)]
dfan <- subset(df1, group == "AN")
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = df1)
df <- read_excel("原始数据.xlsx")
df <- as.data.frame(df)
rownames(df) = df[,1]
df = df[,-1]
df1=df[,c(2,5,13,24:27)]
dfan <- subset(df1, group == "AN")
df <- read_excel("原始数据.xlsx")
df <- as.data.frame(df)
rownames(df) = df[,1]
df = df[,-1]
df1=df[,c(2,5,13,24:27)]
View(df)
View(df)
df <- read_excel("原始数据.xlsx")
df <- as.data.frame(df)
rownames(df) = df[,1]
df = df[,-1]
df1=df[,c(1,2,5,13,24:26)]
dfan <- subset(df1, group == "AN")
dfhc <- subset(df1, group == "HC")
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = df1)
View(df1)
View(dfan)
View(df1)
View(df)
df <- read_excel("原始数据.xlsx")
df <- as.data.frame(df)
rownames(df) = df[,1]
df = df[,-1]
df1=df[,c(1,4,14,24:26)]
dfan <- subset(df1, group == "AN")
dfhc <- subset(df1, group == "HC")
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = df1)
df <- read_excel("原始数据.xlsx")
df <- as.data.frame(df)
rownames(df) = df[,1]
df = df[,-1]
df1=df[,c(1,4,14,24:26)]
dfan <- subset(df1, group == "AN")
dfhc <- subset(df1, group == "HC")
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = df1)
View(df1)
View(df)
df <- read_excel("原始数据.xlsx")
df <- as.data.frame(df)
rownames(df) = df[,1]
df = df[,-1]
df1=df[,c(1,4,12,23:26)]
dfan <- subset(df1, group == "AN")
dfhc <- subset(df1, group == "HC")
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = df1)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
View(df)
df <- read_excel("原始数据.xlsx")
df <- as.data.frame(df)
rownames(df) = df[,1]
df = df[,-1]
df1=df[,c(1,4,10,12,23:26)]
dfan <- subset(df1, group == "AN")
dfhc <- subset(df1, group == "HC")
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = df1)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI+age, data = df1)
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI+Age, data = df1)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI+, data = df1)
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = df1)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
library(nnet)
library(tibble)
library(forestplot)
library(glmnet)
library(caret)
library(foreign)
library(ggplot2)
library(grid)
library(gridExtra)
library(ggpubr)
library(cowplot)
library(ggplot2)
library(readxl)
library(graphics)
library(PerformanceAnalytics)
library(sjPlot)
library(reshape2)
library(dplyr)
library(ggplot2)
library(readxl)
library(gridExtra)
rm(list = ls())#清空数据
df <- read_excel("原始数据.xlsx")
df <- as.data.frame(df)
rownames(df) = df[,1]
df = df[,-1]
df1=df[,c(1,4,10,12,23:26)]
df1$ai=df1$`TNF-a`*df1$`IL-6`
modelan1 <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI+ai, data = dfan)
df <- read_excel("原始数据.xlsx")
df <- as.data.frame(df)
rownames(df) = df[,1]
df = df[,-1]
df1=df[,c(1,4,10,12,23:26)]
df1$ai=df1$`TNF-a`*df1$`IL-6`
dfan <- subset(df1, group == "AN")
dfhc <- subset(df1, group == "HC")
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin, data = df1)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = df1)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
modelan1 <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI+ai, data = dfan)
summary(modelan1)
modelan1 <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI+ai, data = dfan)
summary(modelan1)
modelan1 <- glm(Global ~ `TNF-a`  + `Claudin-5` + Zonulin+ BMI, data = dfan)
summary(modelan1)
modelan2 <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin, data = dfan)
summary(modelan2)
wald_z <- summary(modelan2)$coefficients / summary(modelan2)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
modelan1 <- glm(Global ~`Claudin-5` + Zonulin+ BMI+ai, data = dfan)
summary(modelan1)
modelan1 <- glm(Global ~ `Claudin-5` + Zonulin, data = dfan)
summary(modelan1)
modelan1 <- glm(Global ~ `Claudin-5` + Zonulin+ai, data = dfan)
summary(modelan1)
library(nnet)
library(tibble)
library(forestplot)
library(glmnet)
library(caret)
library(foreign)
library(ggplot2)
library(grid)
library(gridExtra)
library(ggpubr)
library(cowplot)
library(ggplot2)
library(readxl)
library(graphics)
library(PerformanceAnalytics)
library(sjPlot)
library(reshape2)
library(dplyr)
library(ggplot2)
library(readxl)
library(gridExtra)
rm(list = ls())#清空数据
df <- read_excel("原始数据.xlsx")
df <- as.data.frame(df)
rownames(df) = df[,1]
df = df[,-1]
df1=df[,c(1,4,10,12,23:26)]
df1$ai=df1$`TNF-a`*df1$`IL-6`
dfan <- subset(df1, group == "AN")
dfhc <- subset(df1, group == "HC")
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin, data = df1)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin+ BMI, data = df1)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
modelan2 <- glm(Global ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin, data = dfan)
summary(modelan2)
wald_z <- summary(modelan2)$coefficients / summary(modelan2)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
model1 <- model1 <- multinom(group ~ `TNF-a` + `IL-6` + `Claudin-5` + Zonulin, data = df1)
summary(model1)
wald_z <- summary(model1)$coefficients / summary(model1)$standard.errors
p_values <- 2 * (1 - pnorm(abs(wald_z)))
p_values
library(nnet)
library(tibble)
library(forestplot)
library(glmnet)
library(caret)
library(foreign)
library(ggplot2)
library(grid)
library(gridExtra)
library(ggpubr)
library(cowplot)
library(ggplot2)
library(readxl)
library(graphics)
library(PerformanceAnalytics)
library(sjPlot)
library(reshape2)
library(dplyr)
library(ggplot2)
library(readxl)
library(gridExtra)
rm(list = ls())#清空数据
df <- read_excel("原始数据.xlsx")
df <- as.data.frame(df)
rownames(df) = df[,1]
df = df[,-1]
View(df)
dfan <- subset(df1, group == "AN")
dfan <- subset(df, group == "AN")
dfhc <- subset(df, group == "HC")
modelan1 <- glm(LEP ~`general trauma ` +`physical abuse` +`emotional abuse`+`sexual abuse`, data = dfan)
summary(modelan1)
modelan1 <- glm(LEP ~`general trauma ` +`physical abuse` +`emotional abuse`+`sexual abuse`+cohesion+expressiveness+conflict, data = dfan)
summary(modelan1)
